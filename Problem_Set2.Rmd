---
title: "Problem Set 3"
author: "Bailey Kretzler & Sarah Morris"
date: "10/5/2020"
output: html_document
---

In teams of two, address the following questions:

What species (and location if available) did you choose? Why did you choose the species?
What question do you want to answer about this population (e.g. population status, best management strategies)?
Calculate eigenvalue, stable age distribution, elasticity, and sensitivity. What does this tell you about the population?
Using the calculations in part (c), or additional calculations, address the question you proposed in part (b).

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**(a)**

We selected the species *Phaseoulus lunatus*, commonly known as lima bean, in part because it is a food crop but also because of interesting features in the matrix. The matrix describes a threatened wild population of lima bean in Costa Rica. This population is a valuable genetic resource for biodiversity conservation and varietal improvement in other beans. 

**(b)** 

Within the matrix, it is clear that lima beans have strong seed dormancy. Therefore, it would be interesting to follow the trajectory of the associated paper and examine how seed dormancy impacts survival and growth. Specifically, if we decrease seed dormancy and increase seed germination, what happens to species survival in terms of the eigen value? These changes would be reflected in the matrix by increasing the rate at which individuals move from stage G~0~ to L~1~ and proportionally decreasing the number of individuals moving from G~0~ to G~1~. 


**c** To calculate summary statistics about the population, first we need to load it into R and visualize it:
```{r creating/finding matrix}

#alt way to load matrix
grep(pattern = 'Phaseolus', compadre$metadata$Genus)
compadre$metadata$Genus[5735]
compadre$mat[5735][[1]]$matA

Phasmat <- compadre$mat[5735][[1]]$matA

# creating the matrix
#data<- c(0,0.16,0.12,0.08,0,0,0,0,0.14,0.09,0,0,0,0,0,0.01,0,0,0.42,0,0,0.01,0.05,0,28.9,0,0,0,0.16,0.18,104,0,0,0,0,0.25) #data in matrix by column

#Phasmat<- matrix(data = data, nrow = 6, ncol =  6) #creating matrix and inputting above data

colnames(Phasmat) = c("G0", "G1", "J", "L1", "L2", "L3") #assigning the life stage IDs to the column names

Phasmat #viewing matrix

L <- Phasmat # reassigning matrix to object L for leslie matrix

```

In lieu of extracting the matrix from the website, we created the matrix here.

```{r projecting the population behavior}
require(tidyr)
t = 30 # setting time = to 30
Nt = matrix(nrow = nrow(L), ncol = t+1 , data = 0) # creating an initial population matrix


Nt[,1] = 50 #where all life stages are at size 50 in year 1
Nt #checking Nt

L # as defined above

#for loop to determine the size of each life stage across 50 years
for (i in 1:t)
{
	Nt[, i + 1] <- L %*% Nt[,i]
}

Pop <- t(Nt)

time =c(1:31)
Pop_time <- as.data.frame(cbind(Pop, time))
colnames(Pop_time) = c("G0", "G1", "J", "L1", "L2", "L3", "time")
Pop_time <- gather(Pop_time, key = "time", value = "pop")
repeat_t =c(c(1:31),c(1:31),c(1:31),c(1:31),c(1:31),c(1:31))
Pop_time <- cbind(Pop_time, repeat_t)

require(ggplot2)

ggplot(data = Pop_time, aes(x = repeat_t, y = pop, colour = time)) + geom_point(size = 3) + theme_bw() + geom_line() + ggtitle("Population Projection for Original Leslie Matrix", subtitle = "Phaseolus lunatus") +labs(x = "Time in Years", y = "Population size" )

```
Based on the above population projection it seems that at the present fecundity, survival, and growth rates all Lima bean life stages will decrease with time. G0 will see a slight increase due to high fecundity rates but will continue to drop as the number of reproductive lignified individuals (L1, L2, L3) declines.

So why is this the case? What do the eigenvalues and vectors look like?

```{r finding eigenvalues and vectors}

require(popbio)

Lima_eigen <-eigen(L) # using eigen function to find vectors and values

Lima_eigen

elasticity(L)
sensitivity(L)

#our numbers are slightly different from paper - why?
eigen.analysis(L) #another way to visualize the eigen value, eigen vector, sensitivity matrix & elasticity matrix

```
The eigen value of 0.7675902 indicates that the population is declining (because it's less than 1). The right eigenvector, or stable stage distribution indicates .... The sensitivity matrix indicates ... The elasticity matrix indicates ... 


Note from bailey to sarah: Ok, so from here i think it is useful to maybe just change the matrix above like we talked about and then run the analysis again and make another graph to have a visual comparison. I am still kinda sure exactly how the sensitivity analysis/calculation works. Maybe need to spend more time with the site i sent you.. also unsure what the above outputs mean..I agree!


**d**
