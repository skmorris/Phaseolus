---
title: "Problem Set 3"
author: "Bailey Kretzler & Sarah Morris"
date: "10/5/2020"
output: html_document
---

In teams of two, address the following questions:

What species (and location if available) did you choose? Why did you choose the species?
What question do you want to answer about this population (e.g. population status, best management strategies)?
Calculate eigenvalue, stable age distribution, elasticity, and sensitivity. What does this tell you about the population?
Using the calculations in part (c), or additional calculations, address the question you proposed in part (b).

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**(a)**

We selected the species *Phaseoulus lunatus*, common name lima bean, in part because it is a food crop but also because of interesting features in the matrix. The matrix is for a wild population of lima bean that is threatened. This is a valuable genetic resource for biodiversity conservation and varietal improvement in other beans. Within the matrix, it is clear that lima beans have strong seed dormancy that enhance the fitness of the species.

**(b)** 

We thought it would be interesting to follow the trajectory of the associated paper and examine how seed dormancy impacts survival and growth. Specifically, if we decrease seed dormancy and increase seed germination, what happens to species survival in terms of the eigen value? In the matrix this would like increasing the rate at which individuals move from stage G~0~ to L~1~ and proportionally decreasing the number of individuals moving from G~0~ to G~1~. 


**c** this is where we will input code
```{r creating/finding matrix}

# creating the matrix
data<- c(0,0.16,0.12,0.08,0,0,0,0,0.14,0.09,0,0,0,0,0,0.01,0,0,0.42,0,0,0.01,0.05,0,28.9,0,0,0,0.16,0.18,104,0,0,0,0,0.25) #data in matrix by column

Phasmat<- matrix(data = data, nrow = 6, ncol =  6) #creating matrix and inputting above data

colnames(Phasmat) = c("G0", "G1", "J", "L1", "L2", "L3") #assigning the life stage IDs to the column names

Phasmat #viewing matrix

L <- Phasmat # reassigning matrix to object L for leslie matrix

```

In lieu of extracting the matrix from the website, we created the matrix here.

```{r projecting the population behavior}
require(tidyr)
t = 50 # setting time = to 50
Nt = matrix(nrow = nrow(L), ncol = t+1 , data = 0) # creating an initial population matrix

Nt[,1] = 50 #where all life stages are at size 50 in year 1
Nt #checking Nt

L # as defined above

#for loop to determine the size of each life stage across 50 years
for (i in 1:t)
{
	Nt[, i + 1] <- L %*% Nt[,i]
}

Pop <- t(Nt)

time =c(1:51)
Pop_time <- as.data.frame(cbind(Pop, time))
colnames(Pop_time) = c("G0", "G1", "J", "L1", "L2", "L3", "time")
Pop_time <- gather(Pop_time, key = "time", value = "pop")
repeat_t =c(c(1:51),c(1:51),c(1:51),c(1:51),c(1:51),c(1:51))
Pop_time <- cbind(Pop_time, repeat_t)

require(ggplot2)

ggplot(data = Pop_time, aes(x = repeat_t, y = pop, colour = time)) + geom_point()

```



**d**
